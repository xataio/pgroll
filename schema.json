{
  "$ref": "#/definitions/PgRollMigration",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "definitions": {
    "CheckConstraint": {
      "additionalProperties": false,
      "properties": {
        "constraint": {
          "type": "string"
        },
        "name": {
          "type": "string"
        }
      },
      "required": ["constraint", "name"],
      "type": "object"
    },
    "Column": {
      "properties": {
        "check": {
          "$ref": "#/definitions/CheckConstraint"
        },
        "default": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "nullable": {
          "type": "boolean"
        },
        "pk": {
          "type": "boolean"
        },
        "references": {
          "$ref": "#/definitions/ForeignKeyReference"
        },
        "type": {
          "type": "string"
        },
        "unique": {
          "type": "boolean"
        }
      },
      "required": ["name", "nullable", "pk", "type", "unique"],
      "type": "object"
    },
    "ForeignKeyReference": {
      "additionalProperties": false,
      "properties": {
        "column": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "table": {
          "type": "string"
        }
      },
      "required": ["column", "name", "table"],
      "type": "object"
    },
    "OpAddColumn": {
      "additionalProperties": false,
      "properties": {
        "column": {
          "$ref": "#/definitions/Column"
        },
        "table": {
          "type": "string"
        },
        "up": {
          "type": "string"
        }
      },
      "required": ["column", "table"],
      "type": "object"
    },
    "OpAlterColumn": {
      "additionalProperties": false,
      "properties": {
        "check": {
          "$ref": "#/definitions/CheckConstraint"
        },
        "column": {
          "type": "string"
        },
        "down": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "nullable": {
          "type": "boolean"
        },
        "references": {
          "$ref": "#/definitions/ForeignKeyReference"
        },
        "table": {
          "type": "string"
        },
        "type": {
          "type": "string"
        },
        "unique": {
          "$ref": "#/definitions/UniqueConstraint"
        },
        "up": {
          "type": "string"
        }
      },
      "required": ["column", "down", "name", "table", "type", "up"],
      "type": "object"
    },
    "OpCreateIndex": {
      "additionalProperties": false,
      "properties": {
        "columns": {
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "name": {
          "type": "string"
        },
        "table": {
          "type": "string"
        }
      },
      "required": ["columns", "name", "table"],
      "type": "object"
    },
    "OpCreateTable": {
      "additionalProperties": false,
      "properties": {
        "columns": {
          "items": {
            "$ref": "#/definitions/Column"
          },
          "type": "array"
        },
        "name": {
          "type": "string"
        }
      },
      "required": ["columns", "name"],
      "type": "object"
    },
    "OpDropColumn": {
      "additionalProperties": false,
      "properties": {
        "column": {
          "type": "string"
        },
        "down": {
          "type": "string"
        },
        "table": {
          "type": "string"
        }
      },
      "required": ["column", "table"],
      "type": "object"
    },
    "OpDropConstraint": {
      "additionalProperties": false,
      "properties": {
        "column": {
          "type": "string"
        },
        "down": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "table": {
          "type": "string"
        },
        "up": {
          "type": "string"
        }
      },
      "required": ["column", "down", "name", "table", "up"],
      "type": "object"
    },
    "OpDropIndex": {
      "additionalProperties": false,
      "properties": {
        "name": {
          "type": "string"
        }
      },
      "required": ["name"],
      "type": "object"
    },
    "OpDropTable": {
      "additionalProperties": false,
      "properties": {
        "name": {
          "type": "string"
        }
      },
      "required": ["name"],
      "type": "object"
    },
    "OpRawSQL": {
      "additionalProperties": false,
      "properties": {
        "down": {
          "default": "",
          "type": "string"
        },
        "up": {
          "type": "string"
        }
      },
      "required": ["up"],
      "type": "object"
    },
    "OpRenameTable": {
      "additionalProperties": false,
      "properties": {
        "from": {
          "type": "string"
        },
        "to": {
          "type": "string"
        }
      },
      "required": ["from", "to"],
      "type": "object"
    },
    "OpSetReplicaIdentity": {
      "additionalProperties": false,
      "properties": {
        "identity": {
          "$ref": "#/definitions/ReplicaIdentity"
        },
        "table": {
          "type": "string"
        }
      },
      "required": ["identity", "table"],
      "type": "object"
    },
    "PgRollMigration": {
      "additionalProperties": false,
      "properties": {
        "name": {
          "type": "string"
        },
        "operations": {
          "items": {
            "anyOf": [
              {
                "$ref": "#/definitions/OpAddColumn"
              },
              {
                "$ref": "#/definitions/OpAlterColumn"
              },
              {
                "$ref": "#/definitions/OpCreateIndex"
              },
              {
                "$ref": "#/definitions/OpCreateTable"
              },
              {
                "$ref": "#/definitions/OpDropColumn"
              },
              {
                "$ref": "#/definitions/OpDropConstraint"
              },
              {
                "$ref": "#/definitions/OpDropIndex"
              },
              {
                "$ref": "#/definitions/OpDropTable"
              },
              {
                "$ref": "#/definitions/OpRawSQL"
              },
              {
                "$ref": "#/definitions/OpRenameTable"
              },
              {
                "$ref": "#/definitions/OpSetReplicaIdentity"
              }
            ]
          },
          "type": "array"
        }
      },
      "required": ["name", "operations"],
      "type": "object"
    },
    "ReplicaIdentity": {
      "additionalProperties": false,
      "properties": {
        "Index": {
          "type": "string"
        },
        "Type": {
          "type": "string"
        }
      },
      "required": ["Index", "Type"],
      "type": "object"
    },
    "UniqueConstraint": {
      "additionalProperties": false,
      "properties": {
        "name": {
          "type": "string"
        }
      },
      "required": ["name"],
      "type": "object"
    }
  }
}
